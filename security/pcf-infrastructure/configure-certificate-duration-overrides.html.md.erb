---
title: Overriding Duration for Certificates
owner: Ops Manager
---

This topic describes how to set values to override the duration for certificate authority (CA) and leaf certificates managed by <%= vars.ops_manager %> and CredHub.

## <a id='overview'></a> Overview

By default, certificates that <%= vars.ops_manager %> and CredHub generate use the duration set by the tile and certificate authors. These durations can vary from certificate to certificate.
In <%= vars.ops_manager %> v2.10.19 and later, you can set values to override the durations for CA and leaf certificates.
When you apply an override, you can increase certificate duration and reduce the frequency of required certificate rotations.

The following table describes what happens when you enable this feature:

<table>
  <tr>
    <th>If you...</th>
    <th>then...</th>
  </tr>
  <tr>
    <td>configure a duration that is shorter than the default</td>
    <td>the certificate is generated using the default duration.</td>
  </tr>
  <tr>
    <td>configure a duration that is longer than the default</td>
    <td>the certificate is generated using the duration you set.</td>
  </tr>
</table>

For example, <%= vars.app_runtime_first %> might create a leaf certificate with a duration of 365 days.
If you configure the minimum leaf duration to be 730 days, then when <%= vars.app_runtime_abbr %> is first deployed or regenerated, the leaf certificates are created using a duration of 730 days instead.
A <%= vars.app_runtime_abbr %> certificate that is normally created with a duration of 1460 days continues to be created with a duration of 1460 days.

<p class="note"><strong>Note:</strong> <%= vars.recommended_by %> recommends that you do not change your scheduled certificate rotations to use the duration override feature. Instead, you can enable a duration override and use it when the next scheduled rotation takes place.</p>


## <a id='enable'></a> Enable Duration Overrides

To enable the duration override feature:

1. Click the **BOSH Director** tile.
1. Select **Director Config**.
1. Scroll down to the **Certificate Duration Overrides** section.
1. Select the **On** option.
1. Enter the desired duration for CA certificates in the **CA Certificate Duration** field.
1. Enter the desired duration for leaf certificates in the **Leaf Certificate Duration** field.
1. Click **Save**.

After enabling the duration overrides feature, you must take additional steps to apply the setting to existing certificates, as well as any new certificates generated by CredHub.

Depending on your deployment, continue to one of the following sections:

- [Apply a Duration Override on an Existing <%= vars.ops_manager %>](#apply-existing)
- [Apply a Duration Override on a New <%= vars.ops_manager %>](#apply-new)

### <a id='apply-existing'></a> Apply a Duration Override on an Existing <%= vars.ops_manager %>

This procedure describes how to apply a duration override on an existing <%= vars.ops_manager %>.

To apply a duration override:

1. Click **Apply Changes** on the BOSH Director. This ensures that future certificates generated by CredHub use the new duration that you set.
1. To apply a duration override to leaf certificates, you must do a leaf certificate rotation:
    1. To rotate non-configurable leaf certificates, see [Rotating Non-Configurable Leaf Certificates](rotate-non-configurable-certs.html).
    1. To rotate certificates generated using **Generate RSA Certificate**, see [Rotating Configurable Leaf Certificates](rotate-configurable-certs.html).
1. To apply a duration override to both CA and leaf certificates, you must do a full CA rotation. To rotate CAs and leaf certificates, see [Rotating CAs and Leaf Certificates](rotate-cas-and-leaf-certs.html).
1. By default, the Services TLS CA is excluded by the <%= vars.ops_manager %> certificate rotation API. You can rotate this certificate separately to apply the configured duration. To rotate the Services TLS CA, see [Rotate the Services TLS CA and Its Leaf Certificates](advanced-certificate-rotation.html#services-rotation).

### <a id='apply-new'></a> Apply a Duration Override on a New <%= vars.ops_manager %>

This procedure describes how to apply a duration override on a new <%= vars.ops_manager %>.

To apply a duration override:

<p class="note warning"><strong>Warning:</strong> If you have run <strong>Apply Changes</strong> on the BOSH Director tile, you must use the procedure in <a href="#apply-existing">Apply a Duration Override on an Existing <%= vars.ops_manager %></a> above.</p>

1. To apply duration overrides to leaf certificates, no action is required. Leaf certificates are created using the configured duration the first time you run **Apply Changes**.
1. To apply duration overrides to CA certificates, you must regenerate the CA certificates. Follow the procedure in [Rotating CAs and Leaf Certificates](rotate-cas-and-leaf-certs.html) with the following modifications:
    1. You do not need to enable the **Recreate VMs deployed by the BOSH Director** checkbox.
    1. You do not need to run **Apply Changes**.


## <a id='excluded-certs'></a> Excluded Certificates

This section describes the certificates that are excluded from the duration override setting.
The duration override setting applies only to certificates that are rotated by the <%= vars.ops_manager %> certificate rotation procedures.

The following certificates do not use the duration override setting:

* **User-provided certificates:** Products installed using <%= vars.ops_manager %> can contain fields that request operator-provided certificates. These certificates are not generated by <%= vars.ops_manager %> or CredHub.
  <p class="note"><strong>Note</strong>: You can use <strong>Generate RSA Certificate</strong> to generate a certificate instead of requiring an operator-provided certificate. Certificates generated with <strong>Generate RSA Certificate</strong> use the duration overrides you set.

* **<%= vars.ops_manager %> SAML Certificate:** If you configure <%= vars.ops_manager %> to use SAML, UAA uses the <%= vars.ops_manager %> SAML Certificate. This certificate is valid for 730 days, and is not rotated by the same procedure that rotates other certificates. To rotate this certificate, see [How to check and rotate Ops Manager SAML Certificate before it expires](https://community.pivotal.io/s/article/how-to-check-and-rotate-ops-manager-saml-certificate-before-it-expires) in the VMware Tanzu Support documentation.

* **<%= vars.ops_manager %> SSL Certificate:** The <%= vars.ops_manager %> SSL Certificate is used to secure communication between the operator's browser and the <%= vars.ops_manager %> app. By default, this is a self-signed certificate created when the <%= vars.ops_manager %> VM is first launched. This certificate is valid for 365 days, and is automatically regenerated when upgrading <%= vars.ops_manager %>.

* **NATS client certificates:** Each BOSH-deployed VM has a unique NATS client certificate used to communicate with the BOSH Director. This certificate is regenerated each time the VM is re-created.

* **Diego identity certificates:** Each app instance deployed with <%= vars.app_runtime_abbr %> has a unique identity certificate used to communicate with Diego. The Diego Cell rep supplies a new certificate and private key pair to the app instance before the end of the validity period. For more information, see [Using Instance Identity Credentials](https://docs.pivotal.io/application-service/devguide/deploy-apps/instance-identity.html) in the <%= vars.app_runtime_abbr %> documentation.

* All other certificates that have a default duration that is longer than the duration you configure.
